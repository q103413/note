# 微信小程序开发完整教程

## 一、开发准备

### 1.1 注册小程序账号

1. 访问微信公众平台：https://mp.weixin.qq.com
2. 点击"立即注册" → 选择"小程序"
3. 填写账号信息，完成邮箱激活
4. 选择主体类型（个人/企业）
5. 完成主体信息登记
6. 获取 **AppID**（开发者工具中需要使用）

### 1.2 安装开发工具

1. 下载微信开发者工具：https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
2. 安装并使用微信扫码登录
3. 选择"小程序项目"开始开发

### 1.3 创建第一个项目

1. 点击"+"新建项目
2. 填写项目名称
3. 选择项目目录（空文件夹）
4. 输入 AppID（测试可选"测试号"）
5. 选择"不使用云服务"（初学者）
6. 点击"新建"

------

## 二、项目目录结构

```
my-miniprogram/
├── pages/              # 页面文件夹
│   ├── index/         # 首页
│   │   ├── index.js   # 页面逻辑
│   │   ├── index.wxml # 页面结构
│   │   ├── index.wxss # 页面样式
│   │   └── index.json # 页面配置
│   └── logs/          # 日志页
├── utils/             # 工具函数
│   └── util.js
├── app.js             # 小程序逻辑
├── app.json           # 全局配置
├── app.wxss           # 全局样式
├── project.config.json # 项目配置
└── sitemap.json       # 索引配置
```

------

## 三、核心文件详解

### 3.1 app.json（全局配置）

```json
{
  "pages": [
    "pages/index/index",
    "pages/logs/logs"
  ],
  "window": {
    "navigationBarTitleText": "我的小程序",
    "navigationBarBackgroundColor": "#1AAD19",
    "navigationBarTextStyle": "white",
    "backgroundColor": "#eeeeee",
    "backgroundTextStyle": "light"
  },
  "tabBar": {
    "color": "#7A7E83",
    "selectedColor": "#1AAD19",
    "backgroundColor": "#ffffff",
    "list": [
      {
        "pagePath": "pages/index/index",
        "text": "首页",
        "iconPath": "images/home.png",
        "selectedIconPath": "images/home-active.png"
      },
      {
        "pagePath": "pages/logs/logs",
        "text": "日志",
        "iconPath": "images/logs.png",
        "selectedIconPath": "images/logs-active.png"
      }
    ]
  }
}
```

### 3.2 app.js（全局逻辑）

```javascript
App({
  // 小程序启动时执行
  onLaunch: function () {
    console.log('小程序启动')
    // 获取用户信息
    this.getUserInfo()
  },

  // 全局数据
  globalData: {
    userInfo: null,
    apiUrl: 'https://api.example.com'
  },

  // 自定义方法
  getUserInfo: function() {
    wx.getUserProfile({
      desc: '用于完善用户资料',
      success: (res) => {
        this.globalData.userInfo = res.userInfo
      }
    })
  }
})
```

------

## 四、页面开发

### 4.1 WXML（页面结构）

**pages/index/index.wxml**

```xml
<!-- 容器 -->
<view class="container">
  
  <!-- 用户信息 -->
  <view class="userinfo">
    <image class="avatar" src="{{userInfo.avatarUrl}}"></image>
    <text class="username">{{userInfo.nickName}}</text>
  </view>

  <!-- 功能列表 -->
  <view class="function-list">
    <button bindtap="handleClick" type="primary">点击我</button>
    <input placeholder="请输入内容" bindinput="handleInput" value="{{inputValue}}"/>
  </view>

  <!-- 数据列表 -->
  <view class="list">
    <block wx:for="{{list}}" wx:key="id">
      <view class="list-item" bindtap="itemClick" data-id="{{item.id}}">
        <text>{{index + 1}}. {{item.name}}</text>
      </view>
    </block>
  </view>

  <!-- 条件渲染 -->
  <view wx:if="{{isShow}}">显示内容</view>
  <view wx:else>隐藏状态</view>

</view>
```

### 4.2 JS（页面逻辑）

**pages/index/index.js**

```javascript
Page({
  // 页面初始数据
  data: {
    userInfo: {},
    inputValue: '',
    list: [
      { id: 1, name: '项目一' },
      { id: 2, name: '项目二' },
      { id: 3, name: '项目三' }
    ],
    isShow: true
  },

  // 页面加载
  onLoad: function (options) {
    console.log('页面加载', options)
    this.loadData()
  },

  // 页面显示
  onShow: function () {
    console.log('页面显示')
  },

  // 加载数据
  loadData: function() {
    wx.showLoading({ title: '加载中' })
    
    wx.request({
      url: 'https://api.example.com/data',
      method: 'GET',
      success: (res) => {
        this.setData({
          list: res.data
        })
      },
      fail: (err) => {
        wx.showToast({
          title: '加载失败',
          icon: 'none'
        })
      },
      complete: () => {
        wx.hideLoading()
      }
    })
  },

  // 按钮点击事件
  handleClick: function() {
    wx.showToast({
      title: '点击成功',
      icon: 'success'
    })
  },

  // 输入事件
  handleInput: function(e) {
    this.setData({
      inputValue: e.detail.value
    })
  },

  // 列表项点击
  itemClick: function(e) {
    const id = e.currentTarget.dataset.id
    wx.navigateTo({
      url: `/pages/detail/detail?id=${id}`
    })
  },

  // 下拉刷新
  onPullDownRefresh: function() {
    this.loadData()
    wx.stopPullDownRefresh()
  },

  // 分享
  onShareAppMessage: function() {
    return {
      title: '分享标题',
      path: '/pages/index/index'
    }
  }
})
```

### 4.3 WXSS（页面样式）

**pages/index/index.wxss**

```css
.container {
  padding: 20rpx;
  background-color: #f5f5f5;
  min-height: 100vh;
}

.userinfo {
  display: flex;
  align-items: center;
  padding: 30rpx;
  background-color: #fff;
  border-radius: 10rpx;
  margin-bottom: 20rpx;
}

.avatar {
  width: 100rpx;
  height: 100rpx;
  border-radius: 50%;
  margin-right: 20rpx;
}

.username {
  font-size: 32rpx;
  font-weight: bold;
  color: #333;
}

.function-list {
  background-color: #fff;
  padding: 30rpx;
  border-radius: 10rpx;
  margin-bottom: 20rpx;
}

.function-list button {
  margin-bottom: 20rpx;
}

.list {
  background-color: #fff;
  border-radius: 10rpx;
}

.list-item {
  padding: 30rpx;
  border-bottom: 1rpx solid #eee;
}

.list-item:last-child {
  border-bottom: none;
}

.list-item text {
  font-size: 28rpx;
  color: #666;
}
```

------

## 五、常用API

### 5.1 界面交互

```javascript
// 提示框
wx.showToast({
  title: '成功',
  icon: 'success',
  duration: 2000
})

// 模态对话框
wx.showModal({
  title: '提示',
  content: '确定要删除吗？',
  success: (res) => {
    if (res.confirm) {
      console.log('用户点击确定')
    }
  }
})

// 加载提示
wx.showLoading({ title: '加载中' })
wx.hideLoading()

// 操作菜单
wx.showActionSheet({
  itemList: ['选项1', '选项2', '选项3'],
  success: (res) => {
    console.log(res.tapIndex)
  }
})
```

### 5.2 页面路由

```javascript
// 保留当前页面，跳转到新页面
wx.navigateTo({
  url: '/pages/detail/detail?id=1'
})

// 关闭当前页面，跳转到新页面
wx.redirectTo({
  url: '/pages/logs/logs'
})

// 跳转到 tabBar 页面
wx.switchTab({
  url: '/pages/index/index'
})

// 返回上一页
wx.navigateBack({
  delta: 1
})
```

### 5.3 数据存储

```javascript
// 存储数据
wx.setStorageSync('key', 'value')

// 异步存储
wx.setStorage({
  key: 'userInfo',
  data: { name: '张三', age: 25 }
})

// 读取数据
const value = wx.getStorageSync('key')

// 异步读取
wx.getStorage({
  key: 'userInfo',
  success: (res) => {
    console.log(res.data)
  }
})

// 删除数据
wx.removeStorageSync('key')

// 清空数据
wx.clearStorageSync()
```

### 5.4 网络请求

```javascript
wx.request({
  url: 'https://api.example.com/users',
  method: 'POST',
  data: {
    username: 'test',
    password: '123456'
  },
  header: {
    'content-type': 'application/json',
    'token': 'your-token'
  },
  success: (res) => {
    console.log(res.data)
  },
  fail: (err) => {
    console.error(err)
  }
})
```

### 5.5 文件操作

```javascript
// 选择图片
wx.chooseImage({
  count: 1,
  sizeType: ['compressed'],
  sourceType: ['album', 'camera'],
  success: (res) => {
    const tempFilePath = res.tempFilePaths[0]
    // 上传图片
    this.uploadImage(tempFilePath)
  }
})

// 上传文件
uploadImage: function(filePath) {
  wx.uploadFile({
    url: 'https://api.example.com/upload',
    filePath: filePath,
    name: 'file',
    formData: { userId: '123' },
    success: (res) => {
      console.log('上传成功', res.data)
    }
  })
}

// 下载文件
wx.downloadFile({
  url: 'https://example.com/file.pdf',
  success: (res) => {
    wx.openDocument({
      filePath: res.tempFilePath
    })
  }
})
```

------

## 六、组件开发

### 6.1 自定义组件

**创建组件目录：components/card/card.wxml**

```xml
<view class="card">
  <view class="card-title">{{title}}</view>
  <view class="card-content">
    <slot></slot>
  </view>
</view>
```

**components/card/card.js**

```javascript
Component({
  properties: {
    title: {
      type: String,
      value: '默认标题'
    }
  },

  data: {
    // 组件内部数据
  },

  methods: {
    handleTap: function() {
      this.triggerEvent('cardtap', { value: 'test' })
    }
  }
})
```

**components/card/card.json**

```json
{
  "component": true
}
```

### 6.2 使用组件

**pages/index/index.json**

```json
{
  "usingComponents": {
    "card": "/components/card/card"
  }
}
```

**pages/index/index.wxml**

```xml
<card title="卡片标题" bind:cardtap="onCardTap">
  <text>这是卡片内容</text>
</card>
```

------

## 七、实战案例：待办事项小程序

### 7.1 页面结构

```xml
<view class="container">
  <!-- 输入框 -->
  <view class="input-box">
    <input placeholder="添加待办事项" 
           value="{{inputValue}}" 
           bindinput="onInput"
           confirm-type="done"
           bindconfirm="addTodo"/>
    <button size="mini" type="primary" bindtap="addTodo">添加</button>
  </view>

  <!-- 待办列表 -->
  <view class="todo-list">
    <block wx:for="{{todos}}" wx:key="id">
      <view class="todo-item {{item.completed ? 'completed' : ''}}">
        <checkbox checked="{{item.completed}}" 
                  bindtap="toggleTodo" 
                  data-id="{{item.id}}"/>
        <text class="todo-text">{{item.text}}</text>
        <icon type="clear" size="20" bindtap="deleteTodo" data-id="{{item.id}}"/>
      </view>
    </block>
  </view>

  <!-- 统计 -->
  <view class="footer">
    <text>总计：{{todos.length}} | 已完成：{{completedCount}}</text>
  </view>
</view>
```

### 7.2 逻辑代码

```javascript
Page({
  data: {
    inputValue: '',
    todos: []
  },

  onLoad: function() {
    this.loadTodos()
  },

  // 加载数据
  loadTodos: function() {
    const todos = wx.getStorageSync('todos') || []
    this.setData({ todos })
  },

  // 保存数据
  saveTodos: function() {
    wx.setStorageSync('todos', this.data.todos)
  },

  // 输入事件
  onInput: function(e) {
    this.setData({
      inputValue: e.detail.value
    })
  },

  // 添加待办
  addTodo: function() {
    const { inputValue, todos } = this.data
    if (!inputValue.trim()) {
      wx.showToast({ title: '请输入内容', icon: 'none' })
      return
    }

    const newTodo = {
      id: Date.now(),
      text: inputValue,
      completed: false
    }

    this.setData({
      todos: [newTodo, ...todos],
      inputValue: ''
    })
    this.saveTodos()
  },

  // 切换完成状态
  toggleTodo: function(e) {
    const id = e.currentTarget.dataset.id
    const todos = this.data.todos.map(item => {
      if (item.id === id) {
        item.completed = !item.completed
      }
      return item
    })
    this.setData({ todos })
    this.saveTodos()
  },

  // 删除待办
  deleteTodo: function(e) {
    const id = e.currentTarget.dataset.id
    wx.showModal({
      title: '确认删除',
      content: '确定要删除这条待办吗？',
      success: (res) => {
        if (res.confirm) {
          const todos = this.data.todos.filter(item => item.id !== id)
          this.setData({ todos })
          this.saveTodos()
        }
      }
    })
  },

  // 计算已完成数量
  get completedCount() {
    return this.data.todos.filter(item => item.completed).length
  }
})
```

------

## 八、发布上线

### 8.1 代码审核

1. 点击开发者工具"上传"按钮
2. 填写版本号和项目备注
3. 登录小程序后台：https://mp.weixin.qq.com
4. 进入"版本管理"
5. 将开发版本提交审核
6. 填写审核信息（功能介绍、测试账号等）

### 8.2 发布流程

1. 审核通过后（一般1-7天）
2. 在"版本管理"点击"发布"
3. 用户即可在微信中搜索使用

### 8.3 注意事项

- 确保域名已备案并在后台配置
- 所有网络请求必须使用 HTTPS
- 不得违反微信运营规范
- 保证小程序功能完整可用

------

## 九、调试技巧

### 9.1 控制台调试

```javascript
// 打印日志
console.log('普通日志')
console.warn('警告信息')
console.error('错误信息')

// 查看数据
console.table(this.data.list)

// 性能检测
console.time('计时开始')
// ... 执行代码
console.timeEnd('计时开始')
```

### 9.2 真机调试

1. 点击开发者工具"真机调试"
2. 使用微信扫描二维码
3. 在手机上进行调试
4. 查看控制台日志和网络请求

------

## 十、学习资源

**官方文档**

- 微信小程序官方文档：https://developers.weixin.qq.com/miniprogram/dev/framework/

**推荐教程**

- 微信官方教程
- B站视频教程
- 掘金技术社区

**开发工具**

- 微信开发者工具
- VS Code（配合插件）
- 小程序助手（手机端）

**社区论坛**

- 微信开放社区
- SegmentFault
- Stack Overflow

------

## 总结

本教程涵盖了微信小程序开发的核心知识点，从环境搭建到项目发布的完整流程。建议初学者：

1. **动手实践**：边学边做，完成示例项目
2. **查阅文档**：遇到问题优先查看官方文档
3. **参考案例**：研究优秀小程序的实现方式
4. **持续学习**：关注小程序新特性和最佳实践

祝你开发顺利！