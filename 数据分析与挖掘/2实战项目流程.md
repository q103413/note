## 💻 实战项目流程："Talk is cheap, show me the code"

------

### 🛠 环境搭建

1. **安装 Anaconda**

   - 下载地址： https://www.anaconda.com/download

   - 创建并激活虚拟环境：

     ```bash
     conda create -n myenv python=3.10 -y
     conda activate myenv
     ```

2. **安装常用依赖**

   ```bash
   pip install pandas numpy matplotlib seaborn scikit-learn jupyter
   ```

------

### 1️⃣ 数据预处理（Data Preprocessing）

#### 1.1 数据准备

- **数据来源**：官方发布、Kaggle、UCI、网络爬虫

- **导入第三方模块**：

  ```python
  import pandas as pd
  import numpy as np
  ```

- **读取数据**：

  ```python
  df = pd.read_excel('data.xlsx')
  ```

#### 1.2 数据理解

```python
df.head()
df.tail()
df.info()
df.shape
df.dtypes
```

- **自变量（X）** 与 **因变量（y）**

#### 1.3 缺失值 & 重复值处理

```python
# 统计缺失与重复
df.isnull().sum()
df.duplicated().sum()

# 删除重复
df.drop_duplicates(inplace=True)

# 删除缺失
df.dropna(axis=0)

# 填补缺失
df.fillna({'col1': df['col1'].mode()[0],
            'col2': df['col2'].mean()}, inplace=True)
```

#### 1.4 异常值检测

```python
import seaborn as sns
sns.boxplot(x=df['numeric_col'])
```

- 根据可视化结果，决定剔除或替换异常值

------

### 2️⃣ 数据分析（Exploratory Data Analysis）

#### 2.1 描述性统计

```python
df.describe()
df.describe(include=['object'])
```

#### 2.2 数据可视化

- **连续变量**：直方图、核密度、散点图、箱线图、热力图

  ```python
  import matplotlib.pyplot as plt
  sns.histplot(df['age'], kde=True)
  sns.heatmap(df.corr(), annot=True)
  plt.show()
  ```
  
  - **离散量**：饼图、柱状图
  
  ```python
  df['category'].value_counts().plot.pie()
  ```

------

### 3️⃣ 特征工程（Feature Engineering）

#### 3.1 变量编码

```python
# 连续型：标准化 / 归一化
from sklearn.preprocessing import StandardScaler, MinMaxScaler
scaler = StandardScaler()
df[['num1', 'num2']] = scaler.fit_transform(df[['num1', 'num2']])

# 类别型：One-Hot / Label Encoding
df = pd.get_dummies(df, columns=['gender'], drop_first=True)
```

#### 3.2 时间序列处理

```python
df['date'] = pd.to_datetime(df['date'])
```

#### 3.3 特征选择

```python
corr = df.corr()
corr['target'].abs().sort_values(ascending=False)
```

- 可视化：`sns.heatmap(corr, annot=True)`

#### 3.4 数据集划分

```python
from sklearn.model_selection import train_test_split
X = df.drop('target', axis=1)
y = df['target']
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42)
```

------

### 4️⃣ 模型训练与评估

#### 4.1 模型选择

- **分类**：逻辑回归、KNN、决策树、随机森林、SVM
- **回归**：线性回归、岭回归、LASSO、随机森林回归

#### 4.2 模型训练

```python
from sklearn.ensemble import RandomForestClassifier
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)
```

#### 4.3 模型预测

```python
y_pred = model.predict(X_test)
```

#### 4.4 模型评估

```python
from sklearn import metrics
# 分类指标\ nprint(metrics.accuracy_score(y_test, y_pred))
print(metrics.classification_report(y_test, y_pred))

# 回归指标
mse = metrics.mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
r2 = metrics.r2_score(y_test, y_pred)
print(mse, rmse, r2)
```

- **ROC 曲线**：

  ```python
  probs = model.predict_proba(X_test)[:,1]
  fpr, tpr, _ = metrics.roc_curve(y_test, probs)
  ```

5️⃣ 模型优化：网格搜索 + 交叉验证

```python
from sklearn.model_selection import GridSearchCV
param_grid = {'n_estimators': [50, 100], 'max_depth': [5, 10]}
grid = GridSearchCV(RandomForestClassifier(), param_grid,
                    cv=5, scoring='accuracy', verbose=1)
grid.fit(X_train, y_train)
print(grid.best_params_, grid.best_score_)
```

------

## 📋 总结

- 输出最优参数、评估结果
- 分析模型不足与改进方向
- 记录项目收获

------

## ⚙️ 其他配置

```python
import warnings
warnings.filterwarnings('ignore')
import matplotlib.pyplot as plt
plt.rcParams['font.sans-serif'] = ['Songti SC']  # mac
# plt.rcParams['font.sans-serif'] = ['SimHei']  # windows
plt.rcParams['axes.unicode_minus'] = False
```