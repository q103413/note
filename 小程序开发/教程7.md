# 微信小程序开发完整教程（2024版）

从零基础到上线发布，手把手教你打造专属小程序

## 一、认识微信小程序

### 1.1 什么是微信小程序？

微信小程序是一种**无需下载安装、触手可及**的应用形态，运行在微信生态内，具有“用完即走”的特点。它融合了Web的便捷性和原生应用的体验，适用于工具类、电商、社交、教育等多种场景。

### 1.2 核心优势

- **低门槛开发**：使用类HTML/CSS/JS语法，学习成本低；
- **强生态支持**：依托微信10亿+用户，自带社交传播能力；
- **跨平台兼容**：一套代码可在iOS/Android微信客户端运行；
- **丰富API**：支持支付、定位、摄像头、分享等200+原生能力。

## 二、开发环境搭建

### 2.1 注册小程序账号

1. 访问[微信公众平台](https://mp.weixin.qq.com/)，点击「立即注册」→ 选择「小程序」；
2. 填写邮箱、密码，激活邮箱后选择主体类型（个人/企业，个人账号功能受限但足够学习）；
3. 完成实名认证（企业需营业执照，个人需身份证）。

### 2.2 安装开发者工具

- 下载[微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)（选择对应系统版本）；
- 安装后打开，用微信扫码登录（需绑定注册的小程序账号）。

### 2.3 创建第一个项目

1. 点击「新建项目」→ 填写项目信息： **项目名称**：如`MyFirstMiniProgram`； **目录**：选择本地空文件夹； **AppID**：在公众平台「设置→开发设置」中获取（若无AppID，可选择「测试号」，但部分功能受限）； **模板**：选择「JavaScript-基础模板」（含简单页面示例）。
2. 点击「确定」，进入开发界面。

## 三、核心概念与开发基础

### 3.1 小程序文件结构

小程序采用**模块化结构**，核心文件如下：

```
├── pages/               # 页面目录（每个页面一个子文件夹）
│   ├── index/           # 首页（默认页面）
│   │   ├── index.js     # 页面逻辑（数据、事件处理）
│   │   ├── index.json   # 页面配置（如导航栏标题）
│   │   ├── index.wxml   # 页面结构（类似HTML，描述UI）
│   │   └── index.wxss   # 页面样式（类似CSS，美化UI）
│   └── logs/            # 日志页（示例页面）
├── utils/               # 工具函数（如格式化时间、请求封装）
├── app.js               # 全局逻辑（小程序启动时执行，如初始化）
├── app.json             # 全局配置（页面路径、窗口样式、tabBar等）
├── app.wxss             # 全局样式（所有页面共享）
└── project.config.json  # 项目配置（开发者工具个性化设置）
```

### 3.2 双线程模型（核心机制）

小程序采用**逻辑层（JS）** 和**视图层（WebView）** 分离的架构：

- **逻辑层**：运行在独立的JavaScript引擎中，负责处理数据、业务逻辑、网络请求；
- **视图层**：基于WebView渲染WXML/WXSS，负责UI展示；
- **通信方式**：通过微信客户端中转，逻辑层通过`setData`将数据传递给视图层，视图层通过事件（如点击、输入）通知逻辑层。

### 3.3 数据绑定与事件系统

#### 3.3.1 数据绑定（视图随数据更新）

逻辑层通过`data`定义数据，视图层用`{{变量名}}`绑定数据，修改数据需用`setData`触发视图更新。

**示例（index.js）**：

```
Page({
  // 页面初始数据
  data: {
    message: "Hello 小程序！",
    count: 0
  },

  // 按钮点击事件处理函数
  addCount() {
    // 必须用setData更新数据，直接修改this.data.count无效
    this.setData({
      count: this.data.count + 1,
      message: `点击了${this.data.count + 1}次`
    });
  }
});
```

**示例（index.wxml）**：

```
<!-- 文本绑定 -->
<text>{{message}}</text>

<!-- 按钮绑定点击事件 -->
<button bindtap="addCount">点击加1</button>

<!-- 显示count -->
<view>当前计数：{{count}}</view>
```

#### 3.3.2 事件系统（用户交互响应）

常见事件类型：

- `bindtap`：点击事件（最常用）；
- `bindinput`：输入框内容变化时触发；
- `bindsubmit`：表单提交时触发。

**示例（输入框绑定）**：

```
<!-- index.wxml -->
<input bindinput="onInput" placeholder="请输入内容" />

<!-- index.js -->
Page({
  data: { inputValue: "" },
  onInput(e) {
    // e.detail.value 为输入框当前内容
    this.setData({ inputValue: e.detail.value });
  }
});
```

### 3.4 条件渲染与列表渲染

#### 3.4.1 条件渲染（wx:if）

根据数据条件显示/隐藏元素：

```
<!-- 当isShow为true时显示 -->
<view wx:if="{{isShow}}">这是条件渲染的内容</view>
<view wx:else>否则显示这个</view>

<!-- index.js -->
Page({
  data: { isShow: true }
});
```

#### 3.4.2 列表渲染（wx:for）

遍历数组生成多个元素，`wx:key`指定唯一标识（提高性能）：

```
<!-- 遍历tasks数组，每项别名为task，索引为index -->
<view wx:for="{{tasks}}" wx:key="id">
  {{index + 1}}. {{task.name}}（完成：{{task.done ? '是' : '否'}}）
</view>

<!-- index.js -->
Page({
  data: {
    tasks: [
      { id: 1, name: "学习小程序", done: false },
      { id: 2, name: "开发Demo", done: true }
    ]
  }
});
```

## 四、实战案例：TodoList待办事项小程序

### 4.1 需求分析

实现一个简单的待办事项管理功能：

- 添加新任务；
- 标记任务为“已完成”；
- 删除任务；
- 显示任务列表。

### 4.2 步骤1：配置全局文件（app.json）

定义页面路径和窗口样式：

```
{
  "pages": [
    "pages/index/index"  // 首页路径（必填，第一个为首页）
  ],
  "window": {
    "navigationBarTitleText": "TodoList",  // 导航栏标题
    "navigationBarBackgroundColor": "#007AFF",  // 导航栏背景色（蓝色）
    "navigationBarTextStyle": "white"  // 导航栏文字颜色（白色）
  },
  "style": "v2",  // 使用新版组件样式
  "sitemapLocation": "sitemap.json"  // 搜索索引配置（默认即可）
}
```

### 4.3 步骤2：编写首页逻辑（index.js）

```
Page({
  // 初始数据
  data: {
    inputValue: "",  // 输入框内容
    tasks: []        // 任务列表（初始为空）
  },

  // 输入框内容变化时触发
  handleInput(e) {
    this.setData({
      inputValue: e.detail.value  // 更新输入框内容
    });
  },

  // 添加任务
  addTask() {
    const { inputValue, tasks } = this.data;
    // 校验：输入不为空且去除空格后长度>0
    if (!inputValue.trim()) {
      wx.showToast({ title: "请输入任务内容", icon: "none" });
      return;
    }
    // 新增任务（id用时间戳保证唯一）
    const newTask = {
      id: Date.now(),
      name: inputValue.trim(),
      done: false  // 默认未完成
    };
    // 更新任务列表（原列表+新任务）
    this.setData({
      tasks: [...tasks, newTask],  // 展开运算符拼接数组
      inputValue: ""  // 清空输入框
    });
    wx.showToast({ title: "添加成功", icon: "success" });
  },

  // 切换任务完成状态（点击复选框）
  toggleTask(e) {
    const taskId = e.currentTarget.dataset.id;  // 获取点击任务的id（通过data-id传递）
    // 遍历任务列表，找到对应id的任务，反转done状态
    const updatedTasks = this.data.tasks.map(task => 
      task.id === taskId ? { ...task, done: !task.done } : task
    );
    this.setData({ tasks: updatedTasks });
  },

  // 删除任务
  deleteTask(e) {
    const taskId = e.currentTarget.dataset.id;
    // 过滤掉id匹配的任务（保留不匹配的）
    const filteredTasks = this.data.tasks.filter(task => task.id !== taskId);
    this.setData({ tasks: filteredTasks });
    wx.showToast({ title: "删除成功", icon: "success" });
  }
});
```

### 4.4 步骤3：编写首页结构（index.wxml）

```
<view class="container">
  <!-- 标题 -->
  <view class="title">我的待办事项</view>

  <!-- 添加任务区域 -->
  <view class="add-area">
    <input 
      class="input" 
      value="{{inputValue}}" 
      bindinput="handleInput" 
      placeholder="请输入任务..."
    />
    <button class="add-btn" bindtap="addTask">添加</button>
  </view>

  <!-- 任务列表 -->
  <view class="task-list">
    <view wx:if="{{tasks.length === 0}}" class="empty">暂无任务，快去添加吧~</view>
    
    <view wx:else>
      <view 
        wx:for="{{tasks}}" 
        wx:key="id" 
        class="task-item {{task.done ? 'done' : ''}}"
      >
        <!-- 复选框（绑定切换状态事件，传递id） -->
        <checkbox 
          checked="{{task.done}}" 
          bindtap="toggleTask" 
          data-id="{{task.id}}"
        />
        <!-- 任务名称 -->
        <text class="task-name">{{task.name}}</text>
        <!-- 删除按钮（传递id） -->
        <button 
          class="delete-btn" 
          bindtap="deleteTask" 
          data-id="{{task.id}}"
          size="mini"
        >删除</button>
      </view>
    </view>
  </view>
</view>
```

### 4.5 步骤4：编写首页样式（index.wxss）

```
/* 容器样式 */
.container {
  padding: 20rpx;  /* rpx是小程序自适应单位（750rpx=屏幕宽度） */
  background-color: #f5f5f5;
  min-height: 100vh;
}

/* 标题 */
.title {
  font-size: 36rpx;
  font-weight: bold;
  text-align: center;
  margin: 20rpx 0 30rpx;
  color: #333;
}

/* 添加区域 */
.add-area {
  display: flex;
  gap: 10rpx;  /* 子元素间距 */
  margin-bottom: 30rpx;
}
.input {
  flex: 1;  /* 占满剩余空间 */
  height: 80rpx;
  padding: 0 20rpx;
  border: 1rpx solid #ddd;
  border-radius: 8rpx;
  font-size: 28rpx;
}
.add-btn {
  width: 120rpx;
  height: 80rpx;
  background-color: #007AFF;
  color: white;
  border-radius: 8rpx;
  font-size: 28rpx;
}

/* 任务列表 */
.task-list .empty {
  text-align: center;
  color: #999;
  font-size: 28rpx;
  margin-top: 50rpx;
}
.task-item {
  display: flex;
  align-items: center;
  padding: 20rpx;
  background-color: white;
  border-radius: 8rpx;
  margin-bottom: 15rpx;
  box-shadow: 0 2rpx 5rpx rgba(0,0,0,0.05);
}
.task-item.done {
  opacity: 0.6;
}
.task-item.done .task-name {
  text-decoration: line-through;
  color: #999;
}
.task-name {
  flex: 1;
  margin: 0 20rpx;
  font-size: 30rpx;
}
.delete-btn {
  background-color: #ff4d4f;
  color: white;
  border-radius: 6rpx;
}
```

### 4.6 运行效果

保存所有文件后，开发者工具左侧模拟器会实时刷新，可看到：

- 输入任务内容，点击“添加”后显示在列表中；
- 点击复选框，任务文字变灰并添加删除线；
- 点击“删除”，任务从列表中移除。

## 五、进阶功能：调用API与网络请求

### 5.1 常用微信API（原生能力）

小程序提供丰富的API，需在`app.json`中声明权限（部分敏感API需用户授权）。

#### 示例1：获取用户位置

```
// 需先在app.json中声明权限（基础库2.10.4+）
// "permission": { "scope.userLocation": { "desc": "用于获取附近门店" } }

wx.getLocation({
  type: "gcj02",  // 坐标系（国测局坐标，用于地图）
  success(res) {
    console.log("位置信息：", res.latitude, res.longitude);  // 纬度、经度
  },
  fail() {
    wx.showToast({ title: "获取位置失败", icon: "none" });
  }
});
```

#### 示例2：显示提示框

```
wx.showModal({
  title: "提示",
  content: "确定要删除这个任务吗？",
  success(res) {
    if (res.confirm) {
      console.log("用户点击确定");
      // 执行删除逻辑
    }
  }
});
```

### 5.2 网络请求（调用后端接口）

小程序需通过HTTPS请求外部接口，且域名需在公众平台「开发→开发设置→服务器域名」中配置（开发阶段可在开发者工具中勾选「不校验合法域名」临时跳过）。

#### 示例：获取天气数据

```
wx.request({
  url: "https://api.weatherapi.com/v1/current.json",  // 第三方天气API（需替换为自己的接口）
  method: "GET",
  data: {
    key: "YOUR_API_KEY",  // API密钥（需申请）
    q: "北京"
  },
  success(res) {
    console.log("天气数据：", res.data);
    // 更新页面数据：this.setData({ weather: res.data.current })
  },
  fail(err) {
    console.error("请求失败：", err);
  }
});
```

## 六、调试与发布

### 6.1 调试技巧

- **Console面板**：打印日志（`console.log()`）、查看报错；
- **Wxml面板**：实时查看和修改视图结构（类似浏览器DevTools的Elements）；
- **Sources面板**：打断点调试JavaScript逻辑；
- **Network面板**：查看网络请求详情（如请求头、响应数据）。

### 6.2 预览与真机测试

- 点击开发者工具顶部「预览」→ 扫码在手机上测试（需确保手机微信已登录同一账号）；
- 注意：部分API（如支付、蓝牙）仅支持真机调试，模拟器无法模拟。

### 6.3 提交审核与发布

1. **上传代码**：开发者工具顶部「上传」→ 填写版本号和项目备注 → 确认上传（代码会上传到公众平台的「版本管理」）；
2. **提交审核**：登录[微信公众平台](https://mp.weixin.qq.com/)→ 「版本管理」→ 找到刚上传的版本 → 点击「提交审核」（审核通常1-3个工作日）；
3. **发布上线**：审核通过后，在「版本管理」中点击「发布」，小程序即可被微信用户搜索和使用。

## 七、学习资源推荐

- **官方文档**：[微信小程序开发文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)（最权威，含API、组件、框架详解）；
- **社区论坛**：[微信开放社区](https://developers.weixin.qq.com/community/)（提问、看案例）；
- **UI组件库**：[Vant Weapp](https://vant-contrib.gitee.io/vant-weapp/#/intro)（轻量美观的移动端组件库，开箱即用）；
- **实战课程**：B站搜索「微信小程序开发教程」（推荐黑马程序员、尚硅谷等免费教程）。

## 结语

本教程覆盖了小程序开发的核心流程和基础知识，通过TodoList案例可快速上手。实际开发中，还需深入学习组件化、状态管理（如Redux）、云开发等进阶内容。多动手实践、结合官方文档查阅细节，你很快就能开发出功能强大的小程序！