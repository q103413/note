## ğŸ’» å®æˆ˜é¡¹ç›®æµç¨‹ï¼š"Talk is cheap, show me the code"

------

### ğŸ›  ç¯å¢ƒæ­å»º

1. **å®‰è£… Anaconda**

   - ä¸‹è½½åœ°å€ï¼š https://www.anaconda.com/download

   - åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼š

     ```bash
     conda create -n myenv python=3.10 -y
     conda activate myenv
     ```

2. **å®‰è£…å¸¸ç”¨ä¾èµ–**

   ```bash
   pip install pandas numpy matplotlib seaborn scikit-learn jupyter
   ```

------

### 1ï¸âƒ£ æ•°æ®é¢„å¤„ç†ï¼ˆData Preprocessingï¼‰

#### 1.1 æ•°æ®å‡†å¤‡

- **æ•°æ®æ¥æº**ï¼šå®˜æ–¹å‘å¸ƒã€Kaggleã€UCIã€ç½‘ç»œçˆ¬è™«

- **å¯¼å…¥ç¬¬ä¸‰æ–¹æ¨¡å—**ï¼š

  ```python
  import pandas as pd
  import numpy as np
  ```

- **è¯»å–æ•°æ®**ï¼š

  ```python
  df = pd.read_excel('data.xlsx')
  ```

#### 1.2 æ•°æ®ç†è§£

```python
df.head()
df.tail()
df.info()
df.shape
df.dtypes
```

- **è‡ªå˜é‡ï¼ˆXï¼‰** ä¸ **å› å˜é‡ï¼ˆyï¼‰**

#### 1.3 ç¼ºå¤±å€¼ & é‡å¤å€¼å¤„ç†

```python
# ç»Ÿè®¡ç¼ºå¤±ä¸é‡å¤
df.isnull().sum()
df.duplicated().sum()

# åˆ é™¤é‡å¤
df.drop_duplicates(inplace=True)

# åˆ é™¤ç¼ºå¤±
df.dropna(axis=0)

# å¡«è¡¥ç¼ºå¤±
df.fillna({'col1': df['col1'].mode()[0],
            'col2': df['col2'].mean()}, inplace=True)
```

#### 1.4 å¼‚å¸¸å€¼æ£€æµ‹

```python
import seaborn as sns
sns.boxplot(x=df['numeric_col'])
```

- æ ¹æ®å¯è§†åŒ–ç»“æœï¼Œå†³å®šå‰”é™¤æˆ–æ›¿æ¢å¼‚å¸¸å€¼

------

### 2ï¸âƒ£ æ•°æ®åˆ†æï¼ˆExploratory Data Analysisï¼‰

#### 2.1 æè¿°æ€§ç»Ÿè®¡

```python
df.describe()
df.describe(include=['object'])
```

#### 2.2 æ•°æ®å¯è§†åŒ–

- **è¿ç»­å˜é‡**ï¼šç›´æ–¹å›¾ã€æ ¸å¯†åº¦ã€æ•£ç‚¹å›¾ã€ç®±çº¿å›¾ã€çƒ­åŠ›å›¾

  ```python
  import matplotlib.pyplot as plt
  sns.histplot(df['age'], kde=True)
  sns.heatmap(df.corr(), annot=True)
  plt.show()
  ```
  
  - **ç¦»æ•£é‡**ï¼šé¥¼å›¾ã€æŸ±çŠ¶å›¾
  
  ```python
  df['category'].value_counts().plot.pie()
  ```

------

### 3ï¸âƒ£ ç‰¹å¾å·¥ç¨‹ï¼ˆFeature Engineeringï¼‰

#### 3.1 å˜é‡ç¼–ç 

```python
# è¿ç»­å‹ï¼šæ ‡å‡†åŒ– / å½’ä¸€åŒ–
from sklearn.preprocessing import StandardScaler, MinMaxScaler
scaler = StandardScaler()
df[['num1', 'num2']] = scaler.fit_transform(df[['num1', 'num2']])

# ç±»åˆ«å‹ï¼šOne-Hot / Label Encoding
df = pd.get_dummies(df, columns=['gender'], drop_first=True)
```

#### 3.2 æ—¶é—´åºåˆ—å¤„ç†

```python
df['date'] = pd.to_datetime(df['date'])
```

#### 3.3 ç‰¹å¾é€‰æ‹©

```python
corr = df.corr()
corr['target'].abs().sort_values(ascending=False)
```

- å¯è§†åŒ–ï¼š`sns.heatmap(corr, annot=True)`

#### 3.4 æ•°æ®é›†åˆ’åˆ†

```python
from sklearn.model_selection import train_test_split
X = df.drop('target', axis=1)
y = df['target']
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42)
```

------

### 4ï¸âƒ£ æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°

#### 4.1 æ¨¡å‹é€‰æ‹©

- **åˆ†ç±»**ï¼šé€»è¾‘å›å½’ã€KNNã€å†³ç­–æ ‘ã€éšæœºæ£®æ—ã€SVM
- **å›å½’**ï¼šçº¿æ€§å›å½’ã€å²­å›å½’ã€LASSOã€éšæœºæ£®æ—å›å½’

#### 4.2 æ¨¡å‹è®­ç»ƒ

```python
from sklearn.ensemble import RandomForestClassifier
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)
```

#### 4.3 æ¨¡å‹é¢„æµ‹

```python
y_pred = model.predict(X_test)
```

#### 4.4 æ¨¡å‹è¯„ä¼°

```python
from sklearn import metrics
# åˆ†ç±»æŒ‡æ ‡\ nprint(metrics.accuracy_score(y_test, y_pred))
print(metrics.classification_report(y_test, y_pred))

# å›å½’æŒ‡æ ‡
mse = metrics.mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
r2 = metrics.r2_score(y_test, y_pred)
print(mse, rmse, r2)
```

- **ROC æ›²çº¿**ï¼š

  ```python
  probs = model.predict_proba(X_test)[:,1]
  fpr, tpr, _ = metrics.roc_curve(y_test, probs)
  ```

5ï¸âƒ£ æ¨¡å‹ä¼˜åŒ–ï¼šç½‘æ ¼æœç´¢ + äº¤å‰éªŒè¯

```python
from sklearn.model_selection import GridSearchCV
param_grid = {'n_estimators': [50, 100], 'max_depth': [5, 10]}
grid = GridSearchCV(RandomForestClassifier(), param_grid,
                    cv=5, scoring='accuracy', verbose=1)
grid.fit(X_train, y_train)
print(grid.best_params_, grid.best_score_)
```

------

## ğŸ“‹ æ€»ç»“

- è¾“å‡ºæœ€ä¼˜å‚æ•°ã€è¯„ä¼°ç»“æœ
- åˆ†ææ¨¡å‹ä¸è¶³ä¸æ”¹è¿›æ–¹å‘
- è®°å½•é¡¹ç›®æ”¶è·

------

## âš™ï¸ å…¶ä»–é…ç½®

```python
import warnings
warnings.filterwarnings('ignore')
import matplotlib.pyplot as plt
plt.rcParams['font.sans-serif'] = ['Songti SC']  # mac
# plt.rcParams['font.sans-serif'] = ['SimHei']  # windows
plt.rcParams['axes.unicode_minus'] = False
```